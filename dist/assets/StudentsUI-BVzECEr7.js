import{u as C,r as o,j as e,_ as M,g as _}from"./index-Ml_KNG5k.js";import{I as A,G as R}from"./iconBase-CQF-UyDZ.js";import{P as B}from"./index-D7R2zDGA.js";import{H as F}from"./Header-JQxc3_ZZ.js";import"./react-Csw2ODfV.js";import"./firebase-BHdF2iRg.js";function H({onSearch:t}){const{batches:r}=C();console.log(r);const[l,n]=o.useState(""),[s,c]=o.useState(null),x=a=>{n(a)},m=a=>{a.preventDefault(),t(l.trim(),s)};return e.jsx(e.Fragment,{children:e.jsxs("form",{className:"flex gap-1 flex-col",onSubmit:a=>m(a),children:[e.jsxs("div",{className:"flex max-sm:flex-col gap-2 justify-between",children:[e.jsx(A,{type:"text",value:l,onChange:x,label:"رقم التسجيل",parentStyle:"sm:w-1/2 w-full"}),e.jsx("div",{className:"flex flex-col sm:w-1/2 w-full h-10  bg-white text-center rounded relative",children:e.jsxs("select",{className:"w-full h-full bg-white text-center rounded outline-none",value:s||"",onChange:a=>c(a.target.value),children:[e.jsx("option",{value:"",disabled:!0,children:"إختيار الدفعة"}),r.map(a=>e.jsx("option",{value:a.id,children:a.id},a.id))]})})]}),e.jsx("button",{type:"submit",className:"cursor-pointer rounded bg-gray-800 font-bold text-white w-fit self-center px-5 py-3 my-4 hover:text-bg2-color-color hover:bg-s-color transition-all duration-300 ease-linear",children:"إستعلام"})]})})}function V({result:t={},error:r,loading:l}){return e.jsx("div",{className:`bg-gray-800  text-white flex flex-col  justify-center shadow-md p-4 rounded ${l||Object.keys(t).length!==0?"flex":"hidden"}`,children:r?e.jsxs("p",{className:"text-red-400 text-center text-xl flex justify-center items-center",children:[r," ",e.jsx(B,{size:25})]}):l?e.jsxs("div",{className:"flex items-center gap-3 mx-auto",children:[e.jsx("span",{className:"block size-5 border-2 border-bg2-color border-b-transparent rounded-full animate-spin  "}),e.jsx("p",{className:" text-green-600 font-bold text-xl",children:"جاري البحث..."})]}):Object.keys(t).length!==0&&e.jsxs("div",{className:"student-info-containe max-w-2xl mx-auto p-4",children:[e.jsx("div",{className:"text-center w-fit mx-auto ",children:e.jsxs("div",{className:"flex flex-col [&_p]:font-bold",children:[e.jsxs("div",{className:"flex w-70 justify-between bg-rd-200",children:[e.jsx("p",{className:"text--400 mx-auto pr-1",children:t?.name||"N/A"}),e.jsx("p",{className:"min-w-20 text-right bg--200",children:": اسم الطالب"})]}),e.jsxs("div",{className:"flex w-70 justify-between",children:[e.jsx("p",{className:"text--400 mx-auto pr-1",children:t?.stdId||"N/A"}),e.jsx("p",{className:"min-w-20 text-right bg--200",children:": الرقم الجامعي"})]}),e.jsxs("div",{className:"flex w-70 justify-between",children:[e.jsx("p",{className:"text--400 mx-auto pr-1",children:t?.currentSem||"N/A"}),e.jsx("p",{className:"min-w-30 text-right bg--200",children:": الفصل"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 bg-gray-50 mt-4 text-black p-2 rounded-lg min-w-[250px]",children:[e.jsx("div",{className:"font-bold  border-b border-gray-700 text-center",children:"التقدير"}),e.jsx("div",{className:"font-bold  border-b border-gray-700 text-center",children:"المادة"}),t.courses?.map(n=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-center py-1 border-b border-gray-700 font-semibold",children:n.grade||"N/A"}),e.jsx("div",{className:"text-center py-1 border-b border-gray-700 font-semibold",children:n.name||"N/A"})]},n.id))]})]})})}function $(t){return R({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},child:[]}]})(t)}function W(){const[t,r]=o.useState(),[l,n]=o.useState(!1),[s,c]=o.useState(""),[x,m]=o.useState(!0),a=o.useCallback(async(v,g)=>{n(!0),c(""),m(!0);try{const{collection:f,query:S,where:I,getDocs:j}=await M(async()=>{const{collection:u,query:h,where:b,getDocs:N}=await import("./firebase-BHdF2iRg.js").then(p=>p.e);return{collection:u,query:h,where:b,getDocs:N}},[]),w=await _(),D=f(w,`batches/${g}/students`),k=S(D,I("stdId","==",v)),y=(await j(k)).docs[0],d=y.data();if(d.suspend){c("عذراً،تم حجب النتيجة لعدم إكمال إجراء التسجيل");return}else{const u=y.id,h=d.currentSem,b=f(w,`batches/${g}/students/${u}/semesters/${h}/courses`),p=(await j(b)).docs.map(i=>({id:i.id,name:i.data().name||"",degree:i.data().degree||0,grade:i.data().grade||""}));r({name:d.name,stdId:d.stdId,currentSem:d.currentSem,courses:p})}}catch{c("حدث خطأ أثناء البحث")}finally{n(!1)}},[]);return e.jsxs("div",{className:"w-full min-h-[100dvh] bg-[url('https://images.unsplash.com/photo-1576091160550-2173dba999ef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80')] bg-cover bg-center bg-no-repeat min-h-[100dvh]",children:[e.jsx(F,{}),e.jsx(E,{}),e.jsxs("div",{className:" bg-blue-300  shadow-md shadow-white p-5 rounded w-[min(95%,550px)] sticky mt-10  top-50 left-1/2 -translate-x-1/2 -translate-y-1/",children:[e.jsx("h1",{className:"text-center font-extrabold text-3xl mt-3 mb-10 text-title-color",children:"نتائج الطلاب"}),e.jsx(H,{onSearch:a}),x&&e.jsx(V,{result:t,error:s,loading:l})]})]})}const E=()=>{const[t,r]=o.useState(""),l=[{id:"018/M/40319",name:"عنادل علي عبد الباقي",batch:28},{id:"018/M/40320",name:"محمد علي عبد الباقي",batch:28},{id:"019/M/41319",name:"غسان علي عبد الباقي",batch:29}],n=s=>{navigator.clipboard.writeText(s),r(s),setTimeout(()=>r(""),2e3)};return e.jsxs("div",{className:"w-[400px] mx-auto p-6 bg-white rounded-lg shadow-md absolute",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"بيانات بعض الطلاب لغرض الشرح"}),e.jsx("div",{className:"space-y-4",children:l.map((s,c)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-gray-800",children:s.name}),e.jsxs("p",{className:"text-sm font-medium text-gray-500",children:["Batch ",s.batch]}),e.jsx("p",{className:"text-lg font-semibold text-gray-800",children:s.id})]}),e.jsx("button",{onClick:()=>n(s.id),className:"p-2 rounded-md hover:bg-gray-100 transition-colors","aria-label":"Copy ID",children:e.jsx($,{className:`h-5 w-5 ${t===s.id?"text-green-500":"text-gray-400"}`})})]}),t===s.id&&e.jsx("p",{className:"text-xs text-green-500 mt-1 animate-pulse",children:"Copied!"})]},c))})]})};export{W as default};
